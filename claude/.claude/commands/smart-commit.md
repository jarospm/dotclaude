---
description: Analyze changes and create clean conventional commits. Handles single and multi-commit scenarios intelligently.
allowed-tools: Bash(git status:*), Bash(git diff:*), Bash(git log:*), Bash(git show:*)
---

# Smart Commit

Create clean, meaningful git commits following conventional commits format.

## Current Git State

**Status overview:**
!`git status --short`

**Staged changes (ready to commit):**
!`git diff --cached --stat`

**Unstaged changes to tracked files:**
!`git diff --stat`

## Reading git status --short

- First column = staged status, Second column = unstaged status
- `M ` = staged modification, ` M` = unstaged modification
- `A ` = staged new file, `??` = untracked file
- `MM` = staged AND has additional unstaged changes

## Commit Strategy

**If changes ARE already staged:**

- The user made an intentional decision about what to commit
- Treat ALL staged changes as a single logical unit
- Do NOT suggest splitting — respect the user's staging choices
- Proceed directly to creating one commit

**If changes are NOT staged:**

- Analyze with `git diff` for tracked files, inspect contents for untracked
- Consider whether changes span multiple logical concerns (different features, unrelated modules, mix of refactoring and new functionality)
- If clearly separable: propose splitting into multiple commits
- If cohesive: stage all and commit as one
- When in doubt, prefer fewer commits over many tiny ones

## Conventional Commits Format

```
<type>(<scope>): <subject>

<body>
```

### Types

- `feat` — new feature or capability
- `fix` — bug fix
- `refactor` — code change that neither fixes a bug nor adds a feature
- `docs` — documentation only
- `style` — formatting, missing semicolons, etc (not CSS)
- `test` — adding or updating tests
- `chore` — maintenance, dependencies, config
- `perf` — performance improvement

### Rules

**Subject line:**

- Lowercase, no period at end
- Imperative mood: "add" not "added" or "adds"
- Under 50 characters
- What, not how

**Scope:** Module or area affected. Omit if change is broad.

**Body:** 1-2 sentences max explaining WHY (not what). Skip for trivial changes.

## Creating Commits

For each logical commit:

1. Stage files: `git add <files>` or `git add -A`
2. Commit: `git commit -m "<type>(<scope>): <subject>" -m "<body>"`

## Anti-Patterns

- Don't write essays in commit bodies
- Don't describe what the diff already shows
- Don't use past tense ("added", "fixed")
- Don't end subject with period
- Don't commit unrelated changes together (when unstaged)
- Don't split user's intentional staging into multiple commits
- Don't add "Generated by AI" or co-author attributions
